"use strict";!function(){function a(a,b){a.canvas=document.createElement("canvas"),a.ctx=window.UPlayer.getContext(a),a.opt=b||{},a.plugins=a.opt.debug?[window.UPlayer.debug]:[],a.pluginsIndex={},a.curFrame=0}function b(a){c(a);for(var b=0;b<a.plugins.length;)a.plugins[b]&&("function"==typeof a.plugins[b]?a.plugins[b](a.ctx,a.curFrame):"function"==typeof a.plugins[b].render&&a.plugins[b].render(a.ctx,a.curFrame)),++b}function c(a){(a.opt.refresh||void 0===a.opt.refresh)&&a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height)}function d(a){a.style.position="fixed",a.style.top=0,a.style.left=0,a.style.zIndex=1e3,document.body.appendChild(a),e(a),window.onresize=function(){e(a)}}function e(a){a.width=window.innerWidth,a.height=window.innerHeight}function f(a,b){for(var c in a.pluginsIndex)a.pluginsIndex.hasOwnProperty(c)&&a.pluginsIndex[c]>=b&&++a.pluginsIndex[c]}function g(a,b){for(var c in a.pluginsIndex)a.pluginsIndex.hasOwnProperty(c)&&a.pluginsIndex[c]>=b&&++a.pluginsIndex[c]}function h(a,b,c){a.plugins.splice(c,1),a.pluginsIndex[b]=void 0,g(a,c)}function i(a,c,d){var e=+new Date;c||(c=e),(a.playing||d>0)&&(e-c>1e3/(a.opt.fps||30)&&(b(a),++a.curFrame,c=e,void 0!==d&&--d),l.call(window,function(){i(a,c,d)}))}function j(b){var c=this;a(c,b),(void 0===c.opt.fullScreen||c.opt.fullScreen)&&d(c.canvas)}function k(a){for(var b=a.length,c=0;b--;)a[b]>c&&(c=a[b]);return c+1}var l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.setTimeout;j.prototype.plug=function(a){var b=0;if(void 0!==a.zIndex){for(;b<this.plugins.length&&!(a.zIndex<this.plugins[b].zIndex);)++b;this.plugins.splice(b,0,a)}else b=this.plugins.length,this.plugins.push(a);if(void 0!==a.hash){var c=this.pluginsIndex[a.hash];void 0!==c?"object"==typeof c?c.push(b):this.pluginsIndex[a.hash]=[c,b]:(f(this,b),this.pluginsIndex[a.hash]=b)}},j.prototype.plugCard=function(a){var b=this;window.UPlayer.preImage(a.src,function(c){a.img=c,a.render=function(b,d){a.pulse&&a.pulse();var e,f,g,h=a.scale||1;"object"==typeof a.frame?(f=k(a.frame),e=a.frame[d%a.frame.length]):(f=a.frame,e=d%f),g=c.width/f,b.drawImage(c,e*g,0,g,c.height,a.x||0,a.y||0,g*h,c.height*h)},b.plug(a)})},j.prototype.unplug=function(a){var b=this.pluginsIndex[a];if(void 0!==b)if("object"!=typeof b)h(this,a,b);else for(var c=b.length;c--;)h(this,a,b[c])},j.prototype.run=function(a){var b=this;void 0===a&&(b.playing=!0),i(b,null,a)},j.prototype.pause=function(){this.playing=!1},j.prototype.stop=function(){this.curFrame=0,this.playing=!1},window.UPlayer=j}(),function(){function a(a){for(var d in a.raw)"function"==typeof a.raw[d]?b(a,d):c(a,d)}function b(a,b){a[b]=function(){a.raw[b].apply(a.raw,arguments)}}function c(a,b){a.props=a.props||{},a.props[b]={get:function(){return a.raw[b]},set:function(c){a.raw[b]=c}},Object.defineProperties(a,a.props)}function d(){}window.UPlayer.transit={},window.UPlayer.getContext=function(b){var c={raw:b.canvas.getContext("2d")};return a(c),d(c),c}}(),function(){function a(a){return c[a.src]}function b(a){var b=document.createElement("canvas"),d=b.getContext("2d");return b.width=a.width,b.height=a.height,d.drawImage(a,0,0),c[a.src]=b,b}var c={};window.UPlayer.transit.drawImage=function(c){var d=a(c);d||(d=b(c)),arguments[0]=d,this.raw.drawImage.apply(this.raw,arguments)}}(),function(){var a={};window.UPlayer.preImage=function(b,c){function d(){a[b]=e,c(e)}var e=a[b];e?c(e):(e=new Image,e.src=b,e.complete&&d(),e.onload=d)}}(),function(){function a(){if(!f){var a=document.createElement("div"),b=a.style;a.id=g,b.position="fixed",b.top=0,b.right=0,b.zIndex=1e4,b.fontSize="24px",b.color="#fff",b.margin="5px",b.padding="10px",b.background="rgba(0, 0, 0, 0.6)",a.innerText="FPS 0",document.body.appendChild(a),f=!0}}var b,c=+new Date,d=10,e=0,f=!1,g="uplayer-fps";window.UPlayer.debug=function(){a(),++e%d===0&&(b=+new Date,document.getElementById(g).innerText="FPS "+(d/((b-c)/1e3)).toFixed(1),c=b)}}();